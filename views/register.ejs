<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Registration Form - Sewing Camp</title>

<style>
.style1 {font-family: Verdana, Arial, Helvetica, sans-serif;}
.style6 {font-family: Arial, Helvetica, sans-serif; font-size: 10px;}
.style13 {font-family: 'Lucida Handwriting', 'Comic Sans MS', Arial, sans-serif; font-weight: 700; color: #d6336c; font-style: normal; font-size: 20px;}
.style14 {font-family: Arial, Helvetica, sans-serif;}
/* Base page */
body {background: linear-gradient(180deg, #fffefa 0%, #f6f9ff 100%); color: #222;}

/* Navigation Bar Styles */
.navbar {
    background: linear-gradient(135deg, #2a3d66 0%, #0b3d8a 100%);
    padding: 0;
    margin: 0 auto 20px;
    border-radius: 10px;
    box-shadow: 0 6px 20px rgba(42, 61, 102, 0.2);
    max-width: 900px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
}

.navbar-brand {
    display: none;
}

.navbar-menu {
    display: flex;
    list-style: none;
    margin: 0;
    padding: 0;
    flex-wrap: wrap;
}

.navbar-item {
    position: relative;
}

.navbar-item a {
    display: block;
    padding: 18px 16px;
    color: #fff;
    text-decoration: none;
    font-weight: 600;
    font-size: 14px;
    transition: background-color 0.3s, color 0.3s;
    border-bottom: 3px solid transparent;
}

.navbar-item a:hover {
    background-color: rgba(255, 255, 255, 0.15);
    border-bottom-color: #ff8fab;
}

.navbar-item a.active {
    border-bottom-color: #ff8fab;
    color: #ffb8c8;
}

.navbar-actions {
    display: flex;
    gap: 8px;
    padding: 8px 15px;
    flex-wrap: wrap;
    justify-content: flex-end;
}

.btn-login {
    background: linear-gradient(135deg, #ff8fab, #d6336c);
    color: #fff;
    padding: 10px 18px;
    border: none;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    transition: box-shadow 0.3s, transform 0.2s;
}

.btn-login:hover {
    box-shadow: 0 6px 16px rgba(214, 51, 108, 0.35);
    transform: translateY(-2px);
}

.btn-admin {
    background: linear-gradient(135deg, #0b63ff, #0452d4);
    color: #fff;
    padding: 10px 18px;
    border: none;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    transition: box-shadow 0.3s, transform 0.2s;
}

.btn-admin:hover {
    box-shadow: 0 6px 16px rgba(11, 99, 255, 0.35);
    transform: translateY(-2px);
}

.btn-logout {
    background: linear-gradient(135deg, #ef4444, #dc2626);
    color: #fff;
    padding: 10px 18px;
    border: none;
    border-radius: 6px;
    text-decoration: none;
    font-weight: 600;
    font-size: 13px;
    cursor: pointer;
    transition: box-shadow 0.3s, transform 0.2s;
}

.btn-logout:hover {
    box-shadow: 0 6px 16px rgba(239, 68, 68, 0.35);
    transform: translateY(-2px);
}

@media (max-width: 768px) {
    .navbar {
        flex-direction: column;
    }
    
    .navbar-brand {
        width: 100%;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .navbar-menu {
        width: 100%;
        justify-content: center;
    }
    
    .navbar-item a {
        padding: 12px 12px;
        font-size: 13px;
    }
    
    .navbar-actions {
        width: 100%;
        padding: 12px 15px;
        justify-content: center;
    }
}

/* Center the main layout and make it card-like */
table[width="700"] {max-width:900px; margin:20px auto; background: linear-gradient(180deg,#ffffff,#fffafa); border-radius:10px; box-shadow:0 6px 24px rgba(0,0,0,0.12); overflow:hidden;}
/* Form area */
.form-title {margin:18px 0 6px 0; font-size:24px; color:#2a3d66;}
.form-sub {margin-bottom:12px; color:#475569;}
.reg-table {width:100%; max-width:700px; background:transparent;}
.reg-table td {vertical-align:middle; padding:8px 10px;}
input[type="text"], input[type="email"], input[type="tel"], input[type="date"], input[type="number"], select, textarea {border:1px solid #d1d5db; border-radius:6px; padding:8px 10px; box-shadow:inset 0 1px 0 rgba(255,255,255,0.6); background:#fff; transition:box-shadow .15s, border-color .15s;}
input[type="text"]:focus, input[type="email"]:focus, input[type="tel"]:focus, input[type="date"]:focus, input[type="number"]:focus, select:focus, textarea:focus {outline:none; border-color:#7aa2ff; box-shadow:0 0 0 4px rgba(122,162,255,0.12);} 
textarea {resize:vertical}
/* Birthdate + age inline */
input[name="birthdate"] {max-width:220px}
input[name="age"] {width:90px}
/* Button styles */
.btn {background:linear-gradient(180deg,#ff8fab,#d6336c); color:#fff; border:none; padding:10px 18px; border-radius:8px; font-weight:700; cursor:pointer; box-shadow:0 6px 14px rgba(214,51,108,0.24);}
.btn:hover {filter:brightness(0.98); transform:translateY(-1px);} 
/* Agreement/link */
a#termsLink {color:#0b63ff; text-decoration:underline;}
/* Modal (terms) styles */
.modal-overlay {position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.45); display: none; align-items: center; justify-content: center; z-index: 1000;}
.modal {background: #fff; max-width: 640px; width: 92%; padding: 18px; border-radius: 10px; box-shadow: 0 10px 40px rgba(11, 63, 136, 0.24);} 
.modal-header {font-weight: 700; margin-bottom: 8px; color:#0b63ff;}
.modal-close {float: right; cursor: pointer; font-size:20px; padding:6px}
.modal-body p {color:#333; line-height:1.45}

/* Small screens */
@media (max-width:700px){
  table[width="700"] {margin:8px}
  .reg-table td {display:block}
  .reg-table td:first-child {margin-top:8px}
  input[name="birthdate"], input[name="age"]{display:inline-block; margin-right:6px}
}
</style>
<script>
// Ensure navbar sits below banner image on all pages
document.addEventListener('DOMContentLoaded', function(){
    try {
    var nav = document.querySelector('nav.navbar');
    var bannerImg = document.querySelector('img[src="/images/SewingMadeSimpleForKidsBanner.png"]');
    if (nav && bannerImg && bannerImg.parentNode) {
      bannerImg.parentNode.insertBefore(nav, bannerImg.nextSibling);
    }
  } catch(e) { /* no-op */ }
});
</script>
</head>
<body bgcolor="#ffffff">

<table border="0" cellspacing="0" cellpadding="0" width="700">
<tr>
<td colspan="16"><img src="/images/SewingMadeSimpleForKidsBanner.png" width="552" height="100" alt="Sewing Made Simple For Kids Banner"></td>
<td rowspan="2" colspan="4"></td>
<td></td>
</tr>
<tr>
<td colspan="16"></td>
<td></td>
</tr>
</table>

<!-- Navigation Bar -->
<nav class="navbar" role="navigation" aria-label="Main">
    <ul class="navbar-menu">
        <li class="navbar-item"><a href="/">Home</a></li>
        <li class="navbar-item"><a href="/campinfo">Camp Info</a></li>
        <li class="navbar-item"><a href="/campschedule">Schedule</a></li>
        <li class="navbar-item"><a href="/registrations">Registration</a></li>
        <li class="navbar-item"><a href="/contactus">Contact</a></li>
    </ul>
    <div class="navbar-actions">
        <% if (!user) { %>
            <a href="/login" class="btn-login">Login</a>
        <% } else { %>
            <% if (user.is_admin) { %>
                <a href="/admin" class="btn-admin">Admin</a>
            <% } %>
            <a href="/logout" class="btn-logout">Logout</a>
        <% } %>
    </div>
</nav>

<table border="0" cellspacing="0" cellpadding="0" width="700">
<tr>
<td bgcolor="#ffffff" valign="top" colspan="18">
<p class="style13">Registration Form</p>
<p class="style14">Please fill out the information below to register for Sewing Camp. Required fields are marked with *</p>

<form action="/register" method="POST">
  <table class="reg-table" border="0" cellspacing="5" cellpadding="5">
    <tr>
      <td class="style14">First Name*:</td>
      <td><input type="text" name="first_name" required></td>
    </tr>
    <tr>
      <td class="style14">Last Name*:</td>
      <td><input type="text" name="last_name" required></td>
    </tr>
    <tr>
      <td class="style14">Birthdate* / Age*:</td>
      <td>
        <input type="date" name="birthdate" required>
        <input type="number" name="age" readonly required style="width:80px; margin-left:10px;" aria-label="Age (calculated)">
      </td>
    </tr>
    <tr>
      <td class="style14">Email*:</td>
      <td><input type="email" name="email" required></td>
    </tr>
    <tr>
      <td class="style14">Phone*:</td>
      <td><input type="tel" name="phone" required pattern="[0-9]{3}-[0-9]{3}-[0-9]{4}" title="Enter a 10-digit phone number" placeholder="123-456-7890"></td>
    </tr>
    <tr>
      <td class="style14">Street Address*:</td>
      <td><input type="text" name="street_address" required></td>
    </tr>
    <tr>
      <td class="style14">City*:</td>
      <td><input type="text" name="city" required></td>
    </tr>
    <tr>
      <td class="style14">State*:</td>
      <td>
        <select name="state" required>
          <option value="">Select</option>
          <option value="AL">Alabama</option>
          <option value="AK">Alaska</option>
          <option value="AZ">Arizona</option>
          <option value="AR">Arkansas</option>
          <option value="CA">California</option>
          <option value="CO">Colorado</option>
          <option value="CT">Connecticut</option>
          <option value="DE">Delaware</option>
          <option value="FL">Florida</option>
          <option value="GA">Georgia</option>
          <option value="HI">Hawaii</option>
          <option value="ID">Idaho</option>
          <option value="IL">Illinois</option>
          <option value="IN">Indiana</option>
          <option value="IA">Iowa</option>
          <option value="KS">Kansas</option>
          <option value="KY">Kentucky</option>
          <option value="LA">Louisiana</option>
          <option value="ME">Maine</option>
          <option value="MD" selected>Maryland</option>
          <option value="MA">Massachusetts</option>
          <option value="MI">Michigan</option>
          <option value="MN">Minnesota</option>
          <option value="MS">Mississippi</option>
          <option value="MO">Missouri</option>
          <option value="MT">Montana</option>
          <option value="NE">Nebraska</option>
          <option value="NV">Nevada</option>
          <option value="NH">New Hampshire</option>
          <option value="NJ">New Jersey</option>
          <option value="NM">New Mexico</option>
          <option value="NY">New York</option>
          <option value="NC">North Carolina</option>
          <option value="ND">North Dakota</option>
          <option value="OH">Ohio</option>
          <option value="OK">Oklahoma</option>
          <option value="OR">Oregon</option>
          <option value="PA">Pennsylvania</option>
          <option value="RI">Rhode Island</option>
          <option value="SC">South Carolina</option>
          <option value="SD">South Dakota</option>
          <option value="TN">Tennessee</option>
          <option value="TX">Texas</option>
          <option value="UT">Utah</option>
          <option value="VT">Vermont</option>
          <option value="VA">Virginia</option>
          <option value="WA">Washington</option>
          <option value="WV">West Virginia</option>
          <option value="WI">Wisconsin</option>
          <option value="WY">Wyoming</option>
        </select>
      </td>
    </tr>
    <tr>
      <td class="style14">Zip Code*:</td>
      <td><input type="text" name="zipcode" pattern="\d{5}(-\d{4})?" title="Enter 5-digit ZIP or ZIP+4" required></td>
    </tr>
    <!-- Age Group removed: age is computed from birthdate -->
    <tr>
      <td class="style14">Special Requests:</td>
      <td><textarea name="special_requests" rows="3" cols="40" required></textarea></td>
    </tr>
    <tr>
      <td class="style14">Agreement*:</td>
      <td>
        <input type="checkbox" id="agree" name="agree" required>
        <label for="agree">I agree to the <a href="#" id="termsLink">Terms and Conditions</a></label>
      </td>
    </tr>
    <tr>
      <td colspan="2" align="center"><input type="submit" value="Register" class="btn"></td>
    </tr>
  </table>
</form>

<p class="style14">After submitting, you will receive a confirmation email with camp details.</p>
</td>
<td></td>
</tr>

  <script>
  (function () {
    function calculateAgeFromDOB(dobString) {
      if (!dobString) return '';
      const today = new Date();
      const dob = new Date(dobString);
      if (isNaN(dob)) return '';
      let age = today.getFullYear() - dob.getFullYear();
      const m = today.getMonth() - dob.getMonth();
      if (m < 0 || (m === 0 && today.getDate() < dob.getDate())) {
        age--;
      }
      return age >= 0 ? age : '';
    }

    function formatPhoneDigits(digits) {
      if (digits.length < 4) return digits;
      if (digits.length < 7) return digits.slice(0,3) + '-' + digits.slice(3);
      return digits.slice(0,3) + '-' + digits.slice(3,6) + '-' + digits.slice(6,10);
    }

    document.addEventListener('DOMContentLoaded', function () {
      const form = document.querySelector('form[action="/register"]') || document.querySelector('form');
      const birthInput = form.querySelector('input[name="birthdate"]');
      const ageInput = form.querySelector('input[name="age"]');
      const phoneInput = form.querySelector('input[name="phone"]');
      const agreeLink = document.getElementById('termsLink');
      const modalOverlay = document.getElementById('termsModalOverlay');
      const modalCloses = modalOverlay && modalOverlay.querySelectorAll('.modal-close');

      // set max for birthdate to today
      const todayStr = new Date().toISOString().split('T')[0];
      birthInput.setAttribute('max', todayStr);

      function updateAge() {
        const age = calculateAgeFromDOB(birthInput.value);
        ageInput.value = age === '' ? '' : age;
      }

      birthInput.addEventListener('input', updateAge);
      birthInput.addEventListener('change', updateAge);

      // phone formatting on input/blur
      phoneInput.addEventListener('input', function (e) {
        const digits = (e.target.value || '').replace(/\D/g, '').slice(0,10);
        e.target.value = formatPhoneDigits(digits);
      });

      phoneInput.addEventListener('blur', function (e) {
        const digits = (e.target.value || '').replace(/\D/g, '');
        if (digits.length === 10) {
          e.target.value = formatPhoneDigits(digits);
        }
      });

      // Modal open/close for terms
      if (agreeLink && modalOverlay) {
        agreeLink.addEventListener('click', function (ev) {
          ev.preventDefault();
          modalOverlay.style.display = 'flex';
        });
        modalOverlay.addEventListener('click', function (ev) {
          if (ev.target === modalOverlay) modalOverlay.style.display = 'none';
        });
        if (modalCloses && modalCloses.length) modalCloses.forEach(function(el){ el.addEventListener('click', function(){ modalOverlay.style.display = 'none'; }); });
      }

      form.addEventListener('submit', function (e) {
        // ensure age updated
        updateAge();

        // normalize phone to digits then format; require 10 digits
        const digits = (phoneInput.value || '').replace(/\D/g, '');
        if (digits.length !== 10) {
          e.preventDefault();
          alert('Please enter a valid 10-digit phone number.');
          phoneInput.focus();
          return false;
        }
        phoneInput.value = formatPhoneDigits(digits);

        // ensure birthdate present
        if (!birthInput.value) {
          e.preventDefault();
          alert('Please enter a valid birthdate to calculate age.');
          birthInput.focus();
          return false;
        }
        // age will be submitted as readonly input
      });
    });
  })();
  </script>

  <!-- Terms modal -->
  <div id="termsModalOverlay" class="modal-overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="modal">
      <div class="modal-header">Terms and Conditions <span class="modal-close">&times;</span></div>
      <div class="modal-body" style="max-height:60vh; overflow:auto;">
        <p>By registering for Sewing Camp you agree to the camp policies, safety rules, and payment terms. [Replace this placeholder with your full terms and conditions text.]</p>
        <p>Participants must follow instructor directions and adhere to safety guidelines. Parent/guardian consent is required for minors.</p>
      </div>
      <div style="text-align:right; margin-top:8px;"><button type="button" class="modal-close">Close</button></div>
    </div>
  </div>

<tr>
<td colspan="2"><a href="/registrations">Registration Info</a></td>
<td rowspan="5"></td>
<td colspan="17" rowspan="2" align="left" valign="middle" bgcolor="#ffffff">
<p class="style13">Why Attend?</p>
<p class="style14">Sewing Camp is designed to foster creativity, develop skills, and make lifelong friends. Join us for a fun and educational experience!</p>
</td>
<td></td>
</tr>

<tr>
<td rowspan="4" colspan="2"></td>
<td><img src="/images/spacer.gif" width="1" height="347" alt=""></td>
</tr>

<tr>
<td rowspan="2" colspan="17"></td>
<td></td>
</tr>

<tr>
<td></td>
</tr>

<tr>
<td></td>
<td></td>
<td colspan="2"></td>
<td></td>
<td></td>
<td colspan="2"></td>
<td></td>
<td colspan="2"></td>
<td></td>
<td colspan="3"></td>
<td colspan="2"></td>
<td></td>
</tr>
</table>

</body>
</html>

<!-- End of register.ejs -->
